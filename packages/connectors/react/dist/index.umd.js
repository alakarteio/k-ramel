!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("fbjs/lib/shallowEqual")):"function"==typeof define&&define.amd?define(["exports","react","fbjs/lib/shallowEqual"],e):e((t=t||self)["@k-ramel/react"]={},t.React,t["fbjs/lib/shallowEqual"])}(this,function(t,e,n){"use strict";var r="default"in e?e.default:e;function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(){return(s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){u(t,e,n[e])})}return t}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?h(t):e}n=n&&n.hasOwnProperty("default")?n.default:n;var y=function(t){return t.displayName||t.name||t.constructor&&t.constructor.name||"Unknown"},v={},b=function(t){return Object.keys(t).reduce(function(e,n){var r=t[n];return"function"==typeof r?e:a({},e,u({},n,r))},v)},m=[];t.inject=function(t){return function(i){var p,m;return m=p=function(p){function m(e,n){var r;return o(this,m),u(h(r=d(this,l(m).call(this,e,n))),"inject",function(e){r.store&&(r.setState(function(n){return a({},n,{injectedProps:t&&t(r.store,e||r.props,r.store.drivers)||v})}),r.reduxState=r.store.getState())}),r.first=!0,r.reduxState=void 0,r.state={injectedProps:{}},r}return f(m,e.Component),c(m,[{key:"componentWillMount",value:function(){var t=this,e=this.context.store;if(e)this.store=e,this.inject(),this.unsubscribe=e.subscribe(function(){t.store&&t.reduxState===t.store.getState()||t.inject()});else{var n="font-weight: bolder; font-style: italic;";console.error("[k-ramel/react] Error in %cinject%c for the component %c".concat(y(i),"%c\n")+"\t> The store needs to be provided by an ancestor of this component.\n\t> You can use %cprovider%c from %c@k-ramel/react%c or %cProvider%c from %creact-redux%c.\n\nCheck the documentation for an example at https://github.com/alakarteio/k-ramel#connect-it-with-reactjs\n",n,"",n,"",n,"",n,"",n,"",n,"")}}},{key:"componentWillReceiveProps",value:function(t){n(this.props,t)||this.inject(t)}},{key:"shouldComponentUpdate",value:function(t,e){if(this.first)return!0;var r=this.state.injectedProps;return!(n(this.props,t)&&n(b(e.injectedProps),b(r)))}},{key:"componentWillUnmount",value:function(){this.store=void 0,this.unsubscribe()}},{key:"render",value:function(){this.first&&(this.first=!1);var t=this.state.injectedProps;return r.createElement(i,s({},this.props,t))}}]),m}(),u(p,"displayName","inject(".concat(y(i),")")),u(p,"contextTypes",{store:function(){return null}}),m}},t.listen=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,n=arguments.length>1?arguments[1]:void 0;return function(i){var s,a,p=function(t){var e="".concat(t?">":"").concat(t||"");return function(t){return"@@krml/LISTENERS>".concat(t).concat(e)}}(n);return a=s=function(n){function u(){return o(this,u),d(this,l(u).apply(this,arguments))}return f(u,e.Component),c(u,[{key:"componentWillMount",value:function(){var e=this.context.store;e.listeners.add(t),e.dispatch(p("ADDED"))}},{key:"componentWillUnmount",value:function(){var e=this.context.store;e.dispatch(p("REMOVING")),e.listeners.remove(t)}},{key:"render",value:function(){return r.createElement(i,this.props)}}]),u}(),u(s,"displayName","listen(".concat(y(i),")")),u(s,"contextTypes",{store:function(){return null}}),a}},t.provider=function(t){return function(n){var i,s;return s=i=function(i){function u(){return o(this,u),d(this,l(u).apply(this,arguments))}return f(u,e.Component),c(u,[{key:"getChildContext",value:function(){return{store:t}}},{key:"render",value:function(){return r.createElement(n,this.props)}}]),u}(),u(i,"displayName","provider(".concat(y(n),")")),u(i,"childContextTypes",{store:function(){return null}}),s}},Object.defineProperty(t,"__esModule",{value:!0})});
