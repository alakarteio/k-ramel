import{keyValue}from"k-ramel";var defineProperty=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},actions=function(e){return function(r){return{set:function(t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e[t].addOrUpdate(_extends({form:r},n))}},reset:function(t){return function(){return e[t].reset(r)}},onChange:function(t){return function(n){return e.values.addOrUpdate(defineProperty({form:r},t,n))}},destroy:function(){e.values.remove(r),e.errors.remove(r)}}}},selectors=function(e){return function(r){return{exists:function(){return!!e.values.get(r)},get:function(t){return function(n){var o=e[t].get(r);return!n&&o?(delete o.form,o):o&&o[n]||""}}}}},form=function(e){var r=e.path,t=void 0===r?"form":r,n=e.getState,o=void 0===n?function(e){return e.form}:n;return{getReducer:function(){return{path:t,reducer:{values:keyValue({key:"form"}),errors:keyValue({key:"form"})}}},getDriver:function(e){return function(r){var t=o(e),n=actions(t)(r),u=n.set,s=n.reset,i=n.onChange,a=n.destroy,f=selectors(t)(r),c=f.exists,l=f.get;return{exists:c,init:u("values"),destroy:a,get:l("values"),set:u("values"),onChange:i,setErrors:u("errors"),getErrors:l("errors"),clearErrors:s("errors")}}}}};export default form;
