import{types}from"k-ramel";var defineProperty=function(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r},_extends=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},objectWithoutProperties=function(r,e){var t={};for(var n in r)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t},actions=function(r){return function(e){return{set:function(t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r[t].addOrUpdate(_extends({id:e},n))}},reset:function(t){return function(){return r[t].reset(e)}},onChange:function(t){return function(n){return r.values.addOrUpdate(defineProperty({id:e},t,n))}},destroy:function(){r.values.remove(e),r.errors.remove(e)}}}},selectors=function(r){return function(e){return{exists:function(){return!!r.values.get(e)},get:function(t){return function(n){var o=r[t].get(e);if(!n&&o){o.id;return objectWithoutProperties(o,["id"])}return o&&o[n]||""}}}}},form=function(r){var e=r.path,t=void 0===e?"form":e,n=r.getState,o=void 0===n?function(r){return r.form}:n;return{getReducer:function(){return{path:t,reducer:{values:types.keyValue(),errors:types.keyValue()}}},getDriver:function(r){return function(e){var t=o(r),n=actions(t)(e),u=n.set,i=n.reset,s=n.onChange,a=n.destroy,c=selectors(t)(e),f=c.exists,d=c.get;return{exists:f,init:u("values"),destroy:a,get:d("values"),set:u("values"),onChange:s,setErrors:u("errors"),getErrors:d("errors"),clearErrors:i("errors")}}}}};export default form;
