import{types}from"k-ramel";function _defineProperty(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),n.forEach(function(e){_defineProperty(r,e,t[e])})}return r}var actions=function(r){return function(e){return function(t){var n=function(n){return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e[n].addOrUpdate(_objectSpread(_defineProperty({},r,t),o))}};return{set:n("values"),setErrors:n("errors"),clearErrors:function(){return e.errors.reset(t)},update:function(n){return function(o){var u;return e.values.update((_defineProperty(u={},r,t),_defineProperty(u,n,o),u))}},remove:function(){e.values.remove(t),e.errors.remove(t)}}}}},bulkActions=function(r){return function(e){var t=function(t){return function(n){return e[t].addOrUpdate(n.map(function(e){var t=e.name;return _objectSpread({},e.values,_defineProperty({},r,t))}))}};return{set:t("values"),setErrors:t("errors"),clearErrors:e.errors.remove,remove:function(r){e.values.remove(r),e.errors.remove(r)}}}},selectors=function(r){return function(e){return function(t){var n=function(n){return function(o){var u=e[n].get(t);if(!u)return o?"":{};if(!o&&u){var i=_objectSpread({},u);return delete i[r],i}var c=u[o];return null==c?"":c}};return{exists:function(){return!!e.values.get(t)},get:n("values"),getErrors:n("errors")}}}},utils=function(r){return{find:function(e){return r.values.getKeys().filter(function(r){return r.match(e)})}}},form=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.path,t=void 0===e?"form":e,n=r.getState,o=void 0===n?function(r){return r.form}:n,u=r.key,i=void 0===u?"@@form-name":u;return{getReducer:function(){return{path:t,reducer:{values:types.keyValue({key:i}),errors:types.keyValue({key:i})}}},getDriver:function(r){var e=o(r);return Object.assign(function(r){return _objectSpread({},actions(i)(e)(r),selectors(i)(e)(r))},bulkActions(i)(e),utils(e))}}};export default form;
