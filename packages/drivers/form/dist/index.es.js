import{types}from"k-ramel";var defineProperty=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},actions=function(e){return function(r){return function(t){var n,o=function(n){return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r[n].addOrUpdate(_extends(defineProperty({},e,t),o))}};return{init:o("values"),set:o("values"),setErrors:o("errors"),clearErrors:function(){return r.errors.reset(t)},onChange:function(n){return function(o){var u;return r.values.addOrUpdate((defineProperty(u={},e,t),defineProperty(u,n,o),u))}},remove:(n=function(e){r.values.remove(e),r.errors.remove(e)},function(){t instanceof RegExp?r.values.getKeys().filter(function(e){return e.match(t)}).forEach(n):n(t)})}}}},selectors=function(e){return function(r){return function(t){var n=function(n){return function(o){var u=r[n].get(t);if(!o&&u){var i=_extends({},u);return delete i[e],i}return u&&u[o]||""}};return{exists:function(){return!!r.values.get(t)},get:n("values"),getErrors:n("errors")}}}},form=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.path,t=void 0===r?"form":r,n=e.getState,o=void 0===n?function(e){return e.form}:n,u=e.key,i=void 0===u?"@@form-name":u;return{getReducer:function(){return{path:t,reducer:{values:types.keyValue({key:i}),errors:types.keyValue({key:i})}}},getDriver:function(e){return function(r){var t=o(e);return _extends({},actions(i)(t)(r),selectors(i)(t)(r))}}}};export default form;
