!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("k-ramel")):"function"==typeof define&&define.amd?define(["k-ramel"],r):(e=e||self)["@k-ramel/driver-form"]=r(e.kRamel)}(this,function(e){"use strict";function r(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},u=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(u=u.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),u.forEach(function(t){r(e,t,n[t])})}return e}var n=function(e){var r=e.keyName,n=e.keyFields;return function(e){var u=t({},e.payload);return delete u[r],delete u[n],u}},u=function(e){return function(r){return Object.entries(n(e)(r))}};return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=o.path,a=void 0===i?"form":i,f=o.getState,c=void 0===f?function(e){return e.form}:f,s=o.key,l=void 0===s?"@@form-name":s,d=l,v="@@form";"@@form-name"!==l&&(v=l);var y="".concat(v,"-fields");return{getReducer:function(){return{path:a,reducer:{values:e.types.keyValue({key:d}),errors:e.types.keyValue({key:d})}}},getDriver:function(e){var o=c(e);return Object.assign(function(e){return t({},function(e){var n=e.keyName,u=e.keyFields;return function(e){return function(o){var i=function(i){return function(){var a,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e[i].addOrUpdate(t({},f,(r(a={},n,o),r(a,u,Object.keys(f)),a)))}};return{set:i("values"),setErrors:i("errors"),update:function(t){return function(i){var a;return e.values.update((r(a={},n,o),r(a,u,[t]),r(a,t,i),a))}},clearErrors:function(){return e.errors.reset(o)},remove:function(){e.values.remove(o),e.errors.remove(o)}}}}}({keyName:d,keyFields:y})(o)(e),function(e){var r=e.keyName;return function(e){return function(n){var u=function(u){return function(o){var i=e[u].get(n);if(!i)return o?"":{};if(!o&&i){var a=t({},i);return delete a[r],a}var f=i[o];return null==f?"":f}};return{exists:function(){return!!e.values.get(n)},get:u("values"),getErrors:u("errors")}}}}({keyName:d,keyFields:y})(o)(e))},function(e){var n=e.keyName,u=e.keyFields;return function(e){var o=function(o){return function(i){return e[o].addOrUpdate(i.map(function(e){var o,i=e.name,a=e.values;return t({},a,(r(o={},n,i),r(o,u,Object.keys(a)),o))}))}};return{set:o("values"),setErrors:o("errors"),clearErrors:e.errors.remove,remove:function(r){e.values.remove(r),e.errors.remove(r)}}}}({keyName:d,keyFields:y})(o),function(e){return{find:function(r){return e.values.getKeys().filter(function(e){return e.match(r)})}}}(o),function(e){return{getUpdatedFieldNames:(r=e,t=r.keyFields,function(e){return e.payload[t]}),getUpdatedValues:n(e),getUpdatedEntries:u(e)};var r,t}({keyName:d,keyFields:y}))}}}});
