!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("k-ramel")):"function"==typeof define&&define.amd?define(["k-ramel"],r):(e=e||self)["@k-ramel/driver-form"]=r(e.kRamel)}(this,function(e){"use strict";function r(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function n(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},u=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(u=u.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),u.forEach(function(n){r(e,n,t[n])})}return e}return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=t.path,o=void 0===u?"form":u,i=t.getState,a=void 0===i?function(e){return e.form}:i,f=t.key,c=void 0===f?"@@form-name":f,s=c,l="@@form";"@@form-name"!==c&&(l=c);var v="".concat(l,"-fields");return{getReducer:function(){return{path:o,reducer:{values:e.types.keyValue({key:s}),errors:e.types.keyValue({key:s})}}},getDriver:function(e){var t=a(e);return Object.assign(function(e){return n({},function(e){var t=e.keyName,u=e.keyFields;return function(e){return function(o){var i=function(i){return function(){var a,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e[i].addOrUpdate(n({},f,(r(a={},t,o),r(a,u,Object.keys(f)),a)))}};return{set:i("values"),setErrors:i("errors"),update:function(n){return function(i){var a;return e.values.update((r(a={},t,o),r(a,u,[n]),r(a,n,i),a))}},clearErrors:function(){return e.errors.reset(o)},remove:function(){e.values.remove(o),e.errors.remove(o)}}}}}({keyName:s,keyFields:v})(t)(e),function(e){var r=e.keyName;return function(e){return function(t){var u=function(u){return function(o){var i=e[u].get(t);if(!i)return o?"":{};if(!o&&i){var a=n({},i);return delete a[r],a}var f=i[o];return null==f?"":f}};return{exists:function(){return!!e.values.get(t)},get:u("values"),getErrors:u("errors")}}}}({keyName:s,keyFields:v})(t)(e))},function(e){var t=e.keyName,u=e.keyFields;return function(e){var o=function(o){return function(i){return e[o].addOrUpdate(i.map(function(e){var o,i=e.name,a=e.values;return n({},a,(r(o={},t,i),r(o,u,Object.keys(a)),o))}))}};return{set:o("values"),setErrors:o("errors"),clearErrors:e.errors.remove,remove:function(r){e.values.remove(r),e.errors.remove(r)}}}}({keyName:s,keyFields:v})(t),function(e){return{find:function(r){return e.values.getKeys().filter(function(e){return e.match(r)})}}}(t))}}}});
