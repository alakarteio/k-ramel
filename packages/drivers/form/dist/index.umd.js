!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("k-ramel")):"function"==typeof define&&define.amd?define(["k-ramel"],r):(e=e||self)["@k-ramel/driver-form"]=r(e.kRamel)}(this,function(e){"use strict";function r(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},u=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(u=u.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),u.forEach(function(t){r(e,t,n[t])})}return e}var n=function(e){var r=e.keyName,n=e.keyFields;return function(e){var u=t({},e.payload);return delete u[r],delete u[n],u}},u=function(e){return function(r){return Object.entries(n(e)(r))}};return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=o.path,i=void 0===a?"form":a,f=o.getState,c=void 0===f?function(e){return e.form}:f,s=o.key,d=void 0===s?"@@form-name":s,l=d,v="@@form";"@@form-name"!==d&&(v=d);var y="".concat(v,"-fields");return{getReducer:function(){return{path:i,reducer:{values:e.types.keyValue({key:l}),errors:e.types.keyValue({key:l})}}},getDriver:function(e){var o=c(e);return Object.assign(function(e){return t({},function(e){var n=e.keyName,u=e.keyFields;return function(e){return function(o){var a=function(a){return function(){var i,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e[a].add(t({},f,(r(i={},n,o),r(i,u,Object.keys(f)),i)))}},i=function(a){return function(){var i,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e[a].addOrUpdate(t({},f,(r(i={},n,o),r(i,u,Object.keys(f)),i)))}};return{update:function(t){return function(a){var i;return e.values.update((r(i={},n,o),r(i,u,[t]),r(i,t,a),i))}},set:a("values"),addOrUpdate:i("values"),setErrors:a("errors"),addOrUpdateErrors:i("errors"),resetErrors:function(){return e.errors.remove(o)},reset:function(){e.values.remove(o),e.errors.remove(o)}}}}}({keyName:l,keyFields:y})(o)(e),(n={keyName:l,keyFields:y},function(e){return function(r){var u=function(u){return function(o){var a=e[u].get(r);if(!a)return o?"":{};if(!o&&a){var i=t({},a);return Object.values(n).forEach(function(e){delete i[e]}),i}var f=a[o];return null==f?"":f}};return{exists:function(){return!!e.values.get(r)},get:u("values"),getErrors:u("errors")}}})(o)(e));var n},function(e){var n=e.keyName,u=e.keyFields;return function(e){var o=function(o){return function(a){return e[o].add(a.map(function(e){var o,a=e.name,i=e.values;return t({},i,(r(o={},n,a),r(o,u,Object.keys(i)),o))}))}},a=function(o){return function(a){return e[o].addOrUpdate(a.map(function(e){var o,a=e.name,i=e.values;return t({},i,(r(o={},n,a),r(o,u,Object.keys(i)),o))}))}};return{set:o("values"),addOrUpdate:a("values"),setErrors:o("errors"),addOrUpdateErrors:a("errors"),resetErrors:e.errors.remove,reset:function(r){e.values.remove(r),e.errors.remove(r)}}}}({keyName:l,keyFields:y})(o),function(e){return{find:function(r){return e.values.getKeys().filter(function(e){return e.match(r)})}}}(o),function(e){return{getUpdatedFieldNames:(r=e,t=r.keyFields,function(e){return e.payload[t]}),getUpdatedValues:n(e),getUpdatedEntries:u(e)};var r,t}({keyName:l,keyFields:y}))}}}});
