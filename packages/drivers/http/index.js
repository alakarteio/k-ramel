!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t["@k-ramel/driver-http"]=e()}(this,function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},r=function(t){return function(e){return function(n){return function(r,o,u){return t.dispatch({type:"@@http/"+e+">"+n+">"+r,payload:o,status:u})}}}};return function(o){var u={},i=function(i){var a,c,f=(a=regeneratorRuntime.mark(function t(a){for(var c=arguments.length,f=Array(c>2?c-2:0),s=2;s<c;s++)f[s-2]=arguments[s];var p,d,y,h,l,v,m,b,g,E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return p=E.method,d=void 0===p?"GET":p,y=e({},u,E.headers),h=e({},E,{headers:y}),l=r(o)(i)(d),v=void 0,m=void 0,l("STARTED"),t.prev=7,t.next=10,(b=global||window).fetch.apply(b,[a,h].concat(n(f)));case 10:if(m=t.sent,v=m,!(m.headers&&m.headers.get("Content-Type")&&m.headers.get("Content-Type").includes("json"))){t.next=16;break}return t.next=15,m.json();case 15:v=t.sent;case 16:t.next=22;break;case 18:return t.prev=18,t.t0=t.catch(7),l("FAILED",t.t0,(m||{}).status),t.abrupt("return",t.t0);case 22:return g=m.status,l(g>=400||g<200?"FAILED":"ENDED",v,g),t.abrupt("return",v);case 25:case"end":return t.stop()}},t,void 0,[[7,18]])}),c=function(){var t=a.apply(this,arguments);return new Promise(function(e,n){return function r(o,u){try{var i=t[o](u),a=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});e(a)}("next")})},function(t){return c.apply(this,arguments)});return["GET","POST","HEAD","PUT","DELETE","OPTIONS","CONNECT"].forEach(function(n){f[n.toLowerCase()]=function(r,o){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=u.headers,a=void 0===i?{}:i,c=u;return o&&["object","array"].includes(void 0===o?"undefined":t(o))&&(a["Content-Type"]||(c=e({},c,{headers:e({},a,{"Content-Type":"application/json"})})),c=e({},c,{body:JSON.stringify(o)})),c=e({},c,{method:n}),f(r,c)}}),f};return i.setAuthorization=function(t){u.Authorization=t},i}});
//# sourceMappingURL=index.js.map
