function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(r,!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var fromEntries=function(e){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(Array.from(e,function(e){var t=_slicedToArray(e,2);return _defineProperty({},t[0],t[1])}))))},getFilename=function(e){return/filename="(.*)"/g.exec(e)[1]},dispatchFactory=function(e){return function(t,r){return function(n){return function(o,a,i,c,u){return e.dispatch({type:"@@http/".concat(t,">").concat(n,">").concat(o),payload:a,status:i,headers:c,fetch:u,context:r})}}}},getDriver=function(e){var t={},r=function(r,n){var o=function(o){var a,i,c,u,s,p,f,l,y,b,d,h,m,_,g,j=arguments;return regeneratorRuntime.async(function(v){for(;;)switch(v.prev=v.next){case 0:for(a=j.length>1&&void 0!==j[1]?j[1]:{},i=a.method,c=void 0===i?"GET":i,u=_objectSpread2({},t.headers,{},a.headers),s=_objectSpread2({},t,{},a,{headers:u}),p=dispatchFactory(e)(r,n)(c),b=j.length,d=new Array(b>2?b-2:0),h=2;h<b;h++)d[h-2]=j[h];return m=[o,s].concat(d),p("STARTED",void 0,void 0,void 0,m),v.prev=8,v.next=11,regeneratorRuntime.awrap((_=global||window).fetch.apply(_,_toConsumableArray(m)));case 11:if(l=v.sent,f=l,y=fromEntries(l.headers.entries()),!l.headers.has("Content-Disposition")){v.next=22;break}return v.next=17,regeneratorRuntime.awrap(l.blob());case 17:v.t0=v.sent,v.t1=getFilename(l.headers.get("Content-Disposition")),f={blob:v.t0,filename:v.t1},v.next=26;break;case 22:if(!l.headers.has("Content-Type")||!l.headers.get("Content-Type").includes("json")){v.next=26;break}return v.next=25,regeneratorRuntime.awrap(l.json());case 25:f=v.sent;case 26:v.next=32;break;case 28:return v.prev=28,v.t2=v.catch(8),p("FAILED",v.t2,(l||{}).status,y,m),v.abrupt("return",v.t2);case 32:return g=l.status,p(g>=400||g<200?"FAILED":"ENDED",f,g,y),v.abrupt("return",f);case 35:case"end":return v.stop()}},null,null,[[8,28]])};return["GET","POST","HEAD","PATCH","PUT","DELETE","OPTIONS","CONNECT"].forEach(function(e){o[e.toLowerCase()]=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=_objectSpread2({},n.headers),i=n;if(r&&["object","array"].includes(_typeof(r))){var c=r;r instanceof FormData||(a["Content-Type"]=a["Content-Type"]||"application/json",c=JSON.stringify(r)),i=_objectSpread2({},i,{body:c})}return i=_objectSpread2({},i,{method:e,headers:a}),o(t,i)}}),o};return r.setCredentials=function(e){t=_objectSpread2({},t,{credentials:e})},r.setOptions=function(e){t=_objectSpread2({},e,{headers:_objectSpread2({},e.headers)})},r.setAuthorization=function(e){var n=_objectSpread2({},t.headers,{Authorization:e});return e||delete n.Authorization,r.setOptions(_objectSpread2({},t,{headers:n}))},r.clearAuthorization=function(){return r.setAuthorization()},r},http=function(){return{getDriver:getDriver}};export default http;
