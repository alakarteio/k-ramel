var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},asyncToGenerator=function(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){return function n(o,a){try{var i=e[o](a),u=i.value}catch(t){return void r(t)}if(!i.done)return Promise.resolve(u).then(function(t){n("next",t)},function(t){n("throw",t)});t(u)}("next")})}},_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},toConsumableArray=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},_this=void 0,dispatchFactory=function(t){return function(e){return function(r){return function(n,o,a,i){return t.dispatch({type:"@@http/"+e+">"+r+">"+n,payload:o,status:a,fetch:i})}}}},getDriver=function(t){var e={},r={},n=function(n){var o,a=(o=asyncToGenerator(regeneratorRuntime.mark(function o(a){for(var i=arguments.length,u=Array(i>2?i-2:0),s=2;s<i;s++)u[s-2]=arguments[s];var c,f,d,h,y,p,l,v,b,m,A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=A.method,f=void 0===c?"GET":c,d=_extends({},r.headers,e,A.headers),void 0===(h=_extends({},r,A,{headers:d})).headers.Authorization&&delete h.headers.Authorization,y=dispatchFactory(t)(n)(f),p=void 0,l=void 0,v=[a,h].concat(toConsumableArray(u)),y("STARTED",void 0,void 0,v),o.prev=9,o.next=12,(b=global||window).fetch.apply(b,toConsumableArray(v));case 12:if(l=o.sent,p=l,!(l.headers&&l.headers.get("Content-Type")&&l.headers.get("Content-Type").includes("json"))){o.next=18;break}return o.next=17,l.json();case 17:p=o.sent;case 18:o.next=24;break;case 20:return o.prev=20,o.t0=o.catch(9),y("FAILED",o.t0,(l||{}).status,v),o.abrupt("return",o.t0);case 24:return m=l.status,y(m>=400||m<200?"FAILED":"ENDED",p,m),o.abrupt("return",p);case 27:case"end":return o.stop()}},o,_this,[[9,20]])})),function(t){return o.apply(this,arguments)});return["GET","POST","HEAD","PUT","DELETE","OPTIONS","CONNECT"].forEach(function(t){a[t.toLowerCase()]=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=_extends({},n.headers),i=n;if(r&&["object","array"].includes(void 0===r?"undefined":_typeof(r))){var u=r;r instanceof FormData||(o["Content-Type"]=o["Content-Type"]||"application/json",u=JSON.stringify(r)),i=_extends({},i,{body:u})}return i=_extends({},i,{method:t,headers:o}),a(e,i)}}),a};return n.setOptions=function(t){r=t},n.setCredentials=function(t){r=_extends({},r,{credentials:t})},n.setAuthorization=function(t){e.Authorization=t},n.clearAuthorization=function(){return n.setAuthorization()},n},http=function(){return{getDriver:getDriver}};export default http;
//# sourceMappingURL=index.es.js.map
