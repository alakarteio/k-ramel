function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function c(e){asyncGeneratorStep(a,n,o,c,i,"next",e)}function i(e){asyncGeneratorStep(a,n,o,c,i,"throw",e)}c(void 0)})}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var dispatchFactory=function(e){return function(t,r){return function(n){return function(o,a,c,i){return e.dispatch({type:"@@http/".concat(t,">").concat(n,">").concat(o),payload:a,status:c,fetch:i,context:r})}}}},getDriver=function(e){var t={},r=function(r,n){var o=function(){var o=_asyncToGenerator(regeneratorRuntime.mark(function o(a){var c,i,u,s,p,f,y,d,l,b,h,v,S,_,m=arguments;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:for(c=m.length>1&&void 0!==m[1]?m[1]:{},i=c.method,u=void 0===i?"GET":i,s=_objectSpread({},t.headers,c.headers),p=_objectSpread({},t,c,{headers:s}),f=dispatchFactory(e)(r,n)(u),l=m.length,b=new Array(l>2?l-2:0),h=2;h<l;h++)b[h-2]=m[h];return v=[a,p].concat(b),f("STARTED",void 0,void 0,v),o.prev=8,o.next=11,(S=global||window).fetch.apply(S,_toConsumableArray(v));case 11:if(d=o.sent,y=d,!(d.headers&&d.headers.get("Content-Type")&&d.headers.get("Content-Type").includes("json"))){o.next=17;break}return o.next=16,d.json();case 16:y=o.sent;case 17:o.next=23;break;case 19:return o.prev=19,o.t0=o.catch(8),f("FAILED",o.t0,(d||{}).status,v),o.abrupt("return",o.t0);case 23:return _=d.status,f(_>=400||_<200?"FAILED":"ENDED",y,_),o.abrupt("return",y);case 26:case"end":return o.stop()}},o,this,[[8,19]])}));return function(e){return o.apply(this,arguments)}}();return["GET","POST","HEAD","PATCH","PUT","DELETE","OPTIONS","CONNECT"].forEach(function(e){o[e.toLowerCase()]=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=_objectSpread({},n.headers),c=n;if(r&&["object","array"].includes(_typeof(r))){var i=r;r instanceof FormData||(a["Content-Type"]=a["Content-Type"]||"application/json",i=JSON.stringify(r)),c=_objectSpread({},c,{body:i})}return c=_objectSpread({},c,{method:e,headers:a}),o(t,c)}}),o};return r.setCredentials=function(e){t=_objectSpread({},t,{credentials:e})},r.setOptions=function(e){t=_objectSpread({},e,{headers:_objectSpread({},e.headers)})},r.setAuthorization=function(e){var n=_objectSpread({},t.headers,{Authorization:e});return e||delete n.Authorization,r.setOptions(_objectSpread({},t,{headers:n}))},r.clearAuthorization=function(){return r.setAuthorization()},r},http=function(){return{getDriver:getDriver}};export default http;
