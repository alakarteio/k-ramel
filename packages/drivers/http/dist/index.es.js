function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function c(e){asyncGeneratorStep(a,n,o,c,i,"next",e)}function i(e){asyncGeneratorStep(a,n,o,c,i,"throw",e)}c(void 0)})}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var dispatchFactory=function(e){return function(t){return function(r){return function(n,o,a,c){return e.dispatch({type:"@@http/".concat(t,">").concat(r,">").concat(n),payload:o,status:a,fetch:c})}}}},getDriver=function(e){var t={},r=function(r){var n=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(o){var a,c,i,u,s,p,f,y,d,l,b,h,v,S,_=arguments;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(a=_.length>1&&void 0!==_[1]?_[1]:{},c=a.method,i=void 0===c?"GET":c,u=_objectSpread({},t.headers,a.headers),s=_objectSpread({},t,a,{headers:u}),p=dispatchFactory(e)(r)(i),d=_.length,l=new Array(d>2?d-2:0),b=2;b<d;b++)l[b-2]=_[b];return h=[o,s].concat(l),p("STARTED",void 0,void 0,h),n.prev=8,n.next=11,(v=global||window).fetch.apply(v,_toConsumableArray(h));case 11:if(y=n.sent,f=y,!(y.headers&&y.headers.get("Content-Type")&&y.headers.get("Content-Type").includes("json"))){n.next=17;break}return n.next=16,y.json();case 16:f=n.sent;case 17:n.next=23;break;case 19:return n.prev=19,n.t0=n.catch(8),p("FAILED",n.t0,(y||{}).status,h),n.abrupt("return",n.t0);case 23:return S=y.status,p(S>=400||S<200?"FAILED":"ENDED",f,S),n.abrupt("return",f);case 26:case"end":return n.stop()}},n,this,[[8,19]])}));return function(e){return n.apply(this,arguments)}}();return["GET","POST","HEAD","PUT","DELETE","OPTIONS","CONNECT"].forEach(function(e){n[e.toLowerCase()]=function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=_objectSpread({},o.headers),c=o;if(r&&["object","array"].includes(_typeof(r))){var i=r;r instanceof FormData||(a["Content-Type"]=a["Content-Type"]||"application/json",i=JSON.stringify(r)),c=_objectSpread({},c,{body:i})}return c=_objectSpread({},c,{method:e,headers:a}),n(t,c)}}),n};return r.setCredentials=function(e){t=_objectSpread({},t,{credentials:e})},r.setOptions=function(e){t=_objectSpread({},e,{headers:_objectSpread({},e.headers)})},r.setAuthorization=function(e){var n=_objectSpread({},t.headers,{Authorization:e});return e||delete n.Authorization,r.setOptions(_objectSpread({},t,{headers:n}))},r.clearAuthorization=function(){return r.setAuthorization()},r},http=function(){return{getDriver:getDriver}};export default http;
