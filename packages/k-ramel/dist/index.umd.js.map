{"version":3,"file":"index.umd.js","sources":["../src/createStore/reduxFactory.js","../src/createStore/toContext.js","../src/createStore/combine.js","../src/createStore/enhanceRedux/getDevTools.js","../src/createStore/enhanceRedux/listenFactory.js","../src/createStore/enhanceRedux/enhanceRedux.js","../src/createStore/createStore.js","../src/factoryHelpers.js","../src/reaction.js"],"sourcesContent":["import factory from 'k-redux-factory'\n\nexport default (root) => {\n  const subtree = (name, path) => {\n    // first run\n    if (name === undefined) {\n      return Object\n        .keys(root)\n        .map(key => ({ [key]: subtree(key, '') }))\n        .reduce(\n          (acc, next) => ({ ...acc, ...next }),\n          {},\n        )\n    }\n\n    // other runs\n    const nextPath = `${path ? `${path}.` : ''}${name}`\n    const fullpath = `root.${nextPath}`\n    const options = eval(fullpath) // eslint-disable-line no-eval\n    const { type } = options\n\n    // - leaf\n    if (type) { // k-redux-factory\n      return factory({\n        name,\n        path,\n        prefix: (path && path.replace(/\\./g, '_')) || '',\n        ...options,\n      })\n    } else if (typeof options === 'function') { // custom reducer\n      return options\n    }\n\n    // - branch\n    return Object\n      .keys(options)\n      .map(key => ({ [key]: subtree(key, nextPath) }))\n      .reduce(\n        (acc, next) => ({ ...acc, ...next }),\n        {},\n      )\n  }\n\n  return subtree()\n}\n","const withParams = ['get', 'getBy', 'hasKey']\n\nconst keysConfig = {\n  keyValue: [\n    // actions\n    ['set', 'add', 'update', 'addOrUpdate', 'replace', 'remove', 'orderBy', 'reset'],\n    // selectors\n    ['get', 'getBy', 'getKeys', 'getAsArray', 'getLength', 'isInitialized', 'getState', 'hasKey'],\n  ],\n  simpleObject: [\n    // actions\n    ['set', 'update', 'reset'],\n    // selectors\n    ['get', 'isInitialized'],\n  ],\n}\n\nexport default (root, store) => {\n  const subcontext = (name, path) => {\n    // first run\n    if (name === undefined) {\n      return Object\n        .keys(root)\n        .map(key => ({ [key]: subcontext(key, '') }))\n        .reduce(\n          (acc, next) => ({ ...acc, ...next }),\n          {},\n        )\n    }\n\n    // other runs\n    const nextPath = `${path ? `${path}.` : ''}${name}`\n    const fullpath = `root.${nextPath}`\n    const reducer = eval(fullpath) // eslint-disable-line no-eval\n\n    // - leaf\n    if (reducer.krfType !== undefined) {\n      const keys = keysConfig[reducer.krfType]\n      const [actions, selectors] = keys\n\n      const actionsObject = actions\n        .map((action) => {\n          const legacyAction = reducer[action]\n\n          return {\n            [action]: (...args) => store.dispatch(legacyAction(...args)),\n          }\n        })\n        .reduce(\n          (acc, next) => ({ ...acc, ...next }),\n          {},\n        )\n      const selectorsObject = selectors\n        .map((selector) => {\n          const legacySelector = reducer[selector]\n\n          return {\n            [selector]: (...args) => {\n              if (withParams.includes(selector)) return legacySelector(...args)(store.getState())\n              return legacySelector(store.getState())\n            },\n          }\n        })\n        .reduce(\n          (acc, next) => ({ ...acc, ...next }),\n          {},\n        )\n\n      return Object.assign(reducer, actionsObject, selectorsObject)\n    }\n\n    // - branch\n    return Object\n      .keys(reducer)\n      .map(key => ({ [key]: subcontext(key, nextPath) }))\n      .reduce(\n        (acc, next) => ({ ...acc, ...next }),\n        {},\n      )\n  }\n\n  return subcontext()\n}\n","import { combineReducers } from 'redux'\n\nexport default (root) => {\n  const subcombine = (current) => {\n    const reducers = Object\n      .keys(current)\n      .map((key) => {\n        const cur = current[key]\n        if (typeof cur === 'function') return ({ [key]: cur })\n        return ({ [key]: subcombine(cur) })\n      })\n      .reduce(\n        (acc, curr) => ({ ...acc, ...curr }),\n        {},\n      )\n\n    return combineReducers(reducers)\n  }\n\n  return subcombine(root)\n}\n","const getReduxDevToolsEnhancer = name => window.devToolsExtension({ name })\n\nexport default (options) => {\n  const { name, devtools } = options\n\n  // no devtool enable\n  if (!devtools || !window || !window.devToolsExtension) return undefined\n\n  // return enhancer with devtools\n  return getReduxDevToolsEnhancer(name)\n}\n","import { applyMiddleware } from 'redux'\n\nexport default (rootListeners = [], drivers, withDevTools) => {\n  // k-ramel store\n  let innerStore\n\n  // k-ramel listners\n  let innerListeners = [rootListeners]\n\n  return {\n    // this setter is needed since the middleware is pass to redux\n    // createStore, and then BEFORE, we have store instanciated\n    setStore: (store) => {\n      innerStore = store\n    },\n\n    // this is to add new listeners\n    addListeners: (listeners) => {\n      innerListeners = [...innerListeners, listeners]\n    },\n\n    // this is to remove listeners\n    removeListeners: (listeners) => {\n      innerListeners = innerListeners.filter(l => l !== listeners)\n    },\n\n    // redux middleware\n    enhancer: applyMiddleware(() => next => (action) => {\n      const innerAction = withDevTools ? (action.action || action) : action\n\n      // dispatch action\n      const res = next(action)\n\n      // trigger listeners\n      innerListeners\n        .forEach((listeners) => {\n          try {\n            listeners.forEach((listener) => {\n              listener(innerAction, innerStore, innerStore.drivers)\n            })\n          } catch (exception) {\n            innerStore.dispatch({\n              type: '@@krml/EXCEPTION',\n              payload: {\n                from: action,\n                exception,\n                message: exception.message,\n              },\n            })\n          }\n        })\n\n      // return action result\n      return res\n    }),\n  }\n}\n","import { compose } from 'redux'\nimport getDevTools from './getDevTools'\nimport listenFactory from './listenFactory'\n\n/* eslint-env browser */\nexport default (options) => {\n  const { listeners, drivers, enhancer } = options\n\n  // devtools\n  const devtools = getDevTools(options)\n\n  // add custom listeners extension\n  const listen = listenFactory(listeners, drivers, !!devtools)\n\n  const enhancers = [\n    enhancer,\n    devtools,\n    listen.enhancer,\n  ].filter(Boolean)\n\n  // add this middleware to enhancer\n  return { enhancer: compose(...enhancers), listen }\n}\n","import { createStore } from 'redux'\nimport http from '@k-ramel/driver-http'\nimport reduxFactory from './reduxFactory'\nimport toContext from './toContext'\nimport combine from './combine'\nimport enhanceRedux from './enhanceRedux'\n\nconst defaultOptions = {\n  hideRedux: true,\n  enhancer: undefined,\n  init: {},\n  listeners: undefined,\n  devtools: true,\n  name: 'store',\n  drivers: {\n    http,\n  },\n}\n\nexport default (definition, options = defaultOptions) => {\n  // options\n  const innerOptions = {\n    ...defaultOptions,\n    ...options,\n    drivers: {\n      ...defaultOptions.drivers,\n      ...options.drivers,\n    },\n  }\n  const { init, hideRedux, drivers } = innerOptions\n\n  // this is reducer exports (action/selectors)\n  let reducerTree = reduxFactory(definition)\n\n  // instanciate the listen middleware and prepare redux enhancers\n  const { enhancer, listen } = enhanceRedux(innerOptions)\n\n  // this is the redux store\n  const reduxStore = createStore(\n    combine(reducerTree),\n    init,\n    enhancer,\n  )\n\n  // convert to a contextualized version\n  if (hideRedux) {\n    reducerTree = toContext(reducerTree, reduxStore)\n  }\n\n  // store (our own)\n  const store = {\n    ...reducerTree,\n    ...reduxStore,\n    listeners: {\n      add: listen.addListeners,\n      remove: listen.removeListeners,\n    },\n  }\n\n  // store with driver\n  store.drivers = Object.keys(drivers)\n    .reduce(\n      (acc, driver) => ({ ...acc, [driver]: drivers[driver](store) }),\n      {},\n    )\n\n  // custom dispatch\n  const reduxDispatch = store.dispatch\n  store.dispatch = (action, ...args) => {\n    if (typeof action === 'string') return reduxDispatch({ type: action })\n    return reduxDispatch(action, ...args)\n  }\n\n  // pass store to listen (after it has been created)\n  listen.setStore(store)\n\n  return store\n}\n","export const keyValue = params => ({ ...params, type: 'keyValue' })\nexport const simpleObject = params => ({ ...params, type: 'simpleObject' })\n","import { isRegExp, isString, isFunction } from 'lodash'\n\nconst isMatching = (action, store) => matcher => ( // test matching\n  // to a string\n  (\n    isString(matcher) &&\n    action.type === matcher\n  )\n  // to a function\n  || (\n    isFunction(matcher) &&\n    matcher(action, store)\n  )\n  // to a regexp\n  || (\n    isRegExp(matcher) &&\n    action.type.match(matcher)\n  )\n)\n\nexport const when = (...matchers) => callback => (action, store, drivers) => {\n  const match = matchers\n    .reduce((acc, curr) => acc && isMatching(action, store)(curr), true)\n\n  if (match) return callback(action, store, drivers)\n  return false\n}\n\nexport const reaction = fn => Object.assign(\n  fn,\n  { when: (...args) => when(...args)(fn) },\n)\n\nexport const reactions = fns => Object.keys(fns)\n  .reduce((acc, curr) => ({ ...acc, [curr]: reaction(fns[curr]) }), {})\n"],"names":["root","subtree","name","path","undefined","Object","keys","map","key","reduce","acc","next","nextPath","fullpath","options","eval","type","factory","replace","withParams","keysConfig","store","subcontext","reducer","krfType","actions","selectors","actionsObject","action","legacyAction","dispatch","selectorsObject","selector","legacySelector","includes","getState","assign","subcombine","current","reducers","cur","curr","combineReducers","getReduxDevToolsEnhancer","window","devToolsExtension","devtools","rootListeners","withDevTools","innerStore","innerListeners","listeners","filter","l","applyMiddleware","innerAction","res","forEach","listener","drivers","exception","message","enhancer","getDevTools","listen","listenFactory","enhancers","Boolean","compose","defaultOptions","definition","innerOptions","init","hideRedux","reducerTree","reduxFactory","enhanceRedux","reduxStore","createStore","combine","toContext","addListeners","removeListeners","driver","reduxDispatch","args","setStore","keyValue","params","simpleObject","isMatching","matcher","isRegExp","match","when","matchers","callback","reaction","fn","reactions","fns"],"mappings":"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"}